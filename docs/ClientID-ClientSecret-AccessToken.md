<style>
  :root {
    /*--bg: #000000;*/
    --text: #e6e6e6;
    --muted: #a0aec0;
    --accent: #85EA2D;
    --accent-2: #6CBF00;
    --accent-3: #4CAF50;
    --success: #85EA2D;
    --warning: #F59E0B;
    --danger: #EF4444;
    --code-bg: #0d1117;
    --code-border: #2a2f36;
    --table-border: #2a2f36;
    --blockquote-bg: #0f1a12;
    --blockquote-border: #85EA2D;
  
  /* Force dark theme */
  :root { --bg: #121212; --text: #e6e6e6; --muted: #a0aec0; --accent: #85EA2D; --accent-2: #6CBF00; --accent-3: #4CAF50; --success: #85EA2D; --warning: #F59E0B; --danger: #EF4444; --code-bg: #0d1117; --code-border: #2a2f36; --table-border: #2a2f36; --blockquote-bg: #0f1a12; --blockquote-border: #85EA2D; }
  body { background: var(--bg); color: var(--text); font-family: "Segoe UI", system-ui, -apple-system, Roboto, "Helvetica Neue", Arial; font-size: 72px; line-height: 2.0; letter-spacing: 0.15px; }
  h1 { font-size: 4.5em; font-weight: 800; color: var(--text); margin-top: 0.6em; border-bottom: 2px solid var(--table-border); padding-bottom: 0.25em; }
  h2 { font-size: 3.6em; font-weight: 750; color: var(--accent); margin-top: 1.1em; }
  h3 { font-size: 2.8em; font-weight: 700; color: var(--accent-2); margin-top: 1em; }
  h4 { font-size: 2.2em; font-weight: 650; color: var(--accent-3); }
  p, li { font-weight: 500; }
  strong { font-weight: 800; color: var(--text); }
  em { color: var(--muted); }
  a { color: var(--accent); text-underline-offset: 3px; }
  ul, ol { margin: 0.5em 0 1em; }
  li { margin: 0.35em 0; }
  code { background: var(--code-bg); border: 1px solid var(--code-border); padding: 0.25em 0.55em; border-radius: 6px; font-size: 1.2em; }
  pre { background: var(--code-bg); border: 1px solid var(--code-border); padding: 1.2em; border-radius: 10px; overflow: auto; box-shadow: 0 4px 14px rgba(0,0,0,0.25); }
  pre code { background: transparent; border: 0; padding: 0; font-size: 1.2em; }
  table { width: 100%; border-collapse: collapse; margin: 1em 0; font-size: 1.2em; }
  th, td { border: 1px solid var(--table-border); padding: 10px 12px; text-align: left; }
  thead th { background: rgba(37, 99, 235, 0.08); color: var(--text); }
  tbody tr:nth-child(even) { background: rgba(148, 163, 184, 0.08); }
  blockquote { background: var(--blockquote-bg); border-left: 6px solid var(--blockquote-border); padding: 0.8em 1em; border-radius: 8px; color: var(--text); }
  .badge { display: inline-block; padding: 0.2em 0.6em; border-radius: 999px; font-size: 0.8em; font-weight: 700; }
  .badge.info { background: rgba(37,99,235,0.12); color: var(--accent); }
  .badge.success { background: rgba(16,185,129,0.12); color: var(--success); }
  .badge.warn { background: rgba(245,158,11,0.12); color: var(--warning); }
  .badge.danger { background: rgba(239,68,68,0.12); color: var(--danger); }
  .callout { border-left: 6px solid var(--accent); background: rgba(37,99,235,0.08); padding: 0.9em 1em; border-radius: 8px; margin: 1em 0; }
  .callout.warning { border-color: var(--warning); background: rgba(245,158,11,0.08); }
  .callout.success { border-color: var(--success); background: rgba(16,185,129,0.08); }
  .callout.danger { border-color: var(--danger); background: rgba(239,68,68,0.08); }
</style>
## ðŸ”‘ **Client ID, Client Secret, and Access Token**

â€” A Practical Guide for OAuth2/OIDC Clients â€”

## ðŸ§­ **Contents**

- Client ID vs Client Secret
- When the Client Sends the Secret
- Who Authenticates Whom?
- Who Issues Tokens?
- Resource Access Flow
- Clearing Up Confusion
- How client_id is assigned
- Client Registration (What IAM stores)

1. Client ID vs Client Secret

| Item | What it is | Example | Security Note |
|------|------------|---------|---------------|
| client_id | Public identifier for the app | `my-mobile-app` | Safe if leaked |
| client_secret | Password generated by IAM at registration | `Xyz123$SuperSecret` | Never embed in SPAs/mobile |

Notes

- client_id + client_secret are stored by IAM. The secret is only used when exchanging for tokens, not on every request.

2. When does the client send the secret?

a) Client Registration (one-time)

- IAM stores `client_id`
- IAM gives `client_secret` once; store hashed in DB (like a password)

b) Token Request (ongoing)

When requesting an access token, the client authenticates with `client_id` + `client_secret`.

HTTP example

```http
POST /token
Authorization: Basic base64(client_id:client_secret)
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&code=abc123&redirect_uri=https://myapp/callback
```

Best practice: Authorization header. A less secure alternative is putting credentials in the body.

3. Who authenticates who?

- IAM authenticates clients using `client_id` + `client_secret` (or mTLS/JWT assertion)
- IAM authenticates users with username/password, biometrics, social, etc.
- Both happen only at the Authorization Server (IAM).

4. Who issues tokens?

Only the `/token` endpoint issues tokens:

- Access Token: short-lived (5â€“15 minutes), used for API calls
- Refresh Token: long-lived, used to get new access tokens

Not during login, not during `checkAccess`, not during registration.

Flow

1. Client redirects user to `/authorize`
2. IAM authenticates user and returns authorization code
3. Client calls `/token` with `client_id` + `client_secret` + `code`
4. IAM issues access and refresh tokens

5. Resource Access Flow

1. Client registers â†’ gets `client_id` + `client_secret`
2. User logs in â†’ IAM issues access + refresh tokens
3. Client calls APIs with `Authorization: Bearer <access_token>`
4. Resource server validates token, reads `sub` and `client_id`, applies policies, returns allow/deny

6. Clearing up Confusion

- User authentication is IAMâ€™s job, but tokens are only issued at `/token`
- Client authentication: the secret is used only at `/token`, not every API call
- Client registration (often admin-driven) is not the same as login

Key Takeaway

```text
client_id = public app identifier
client_secret = private app password (confidential clients only)
access_token = proof used on every API call
refresh_token = used at /token to obtain new access tokens
/token = the only place tokens are created/rotated
```

7. How client_id is assigned

- Generated by IAM (not by the client)
- Must be unique and unguessable

```json
{
  "client_id": "c1c839f0-9aa2-4a21-9e42-98a6f9ffac3b",
  "client_secret": "jDk8sh2...."
}
```

8. Client Registration (What IAM stores)

| Field | Purpose |
|------|---------|
| id (internal PK) | DB primary key |
| client_id | Public identifier (unique, IAM-generated) |
| client_secret_hash | Hashed secret (confidential clients) |
| name | Human-friendly name |
| type | `public` (SPA, mobile) or `confidential` (server) |
| redirect_uris | Allowed callback URLs |
| grant_types | Allowed OAuth2 flows |
| scopes | Allowed scopes |
| audience | Allowed resource servers |
| created_at / updated_at | Audit fields |
| status | Active / disabled |

Optional fields

- `jwks_uri`
- `allowed_cors_origins`
- `token_endpoint_auth_method`

Dynamic Client Registration â€” Request

```json
{
  "client_name": "My Mobile App",
  "redirect_uris": ["https://myapp.com/callback"],
  "grant_types": ["authorization_code", "refresh_token"],
  "response_types": ["code"],
  "scope": "openid profile read:invoices",
  "token_endpoint_auth_method": "client_secret_basic"
}
```

Dynamic Client Registration â€” Response

```json
{
  "client_id": "c1c839f0-9aa2-4a21-9e42-98a6f9ffac3b",
  "client_secret": "Xyz123$SuperSecret",
  "client_name": "My Mobile App",
  "redirect_uris": ["https://myapp.com/callback"],
  "grant_types": ["authorization_code", "refresh_token"],
  "scope": "openid profile read:invoices"
}
```

Admin-controlled registration (simpler)

- Admins create clients in the IAM dashboard
- IAM provides `client_id` + `client_secret` out-of-band (copy once)
- Most production systems do this (Keycloak/Okta). Dynamic registration is optional and often disabled for security.

TL;DR

- DB stores â†’ `client_id`, `client_secret_hash`, type, URIs, grants, scopes
- Client provides â†’ name, redirect URIs, grant types, scopes
- IAM generates â†’ `client_id` and `client_secret`